{% extends "base.html.j2" %}

{% block title %}Dashboard - StoryGrab{% endblock %}

{% block content %}
  <div class="p-6 bg-gray-800/40 border border-gray-700 rounded-lg shadow-sm">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h1 class="text-2xl font-bold mb-1 text-white">Dashboard</h1>
        <p class="text-sm text-gray-400">Manage StoryGraph matches and LazyLibrarian integration.</p>
      </div>
    </div>

    <div class="space-y-4">
      <section class="bg-gray-900 p-4 rounded-lg border border-gray-700">
        <h2 class="text-lg font-semibold text-white mb-3">Match StoryGraph â†’ LazyLibrarian</h2>
        <p class="text-sm text-gray-400 mb-3">Enter a StoryGraph username to fetch their to-read list and match titles against your LazyLibrarian library. Matches are performed locally; use the "Search LL" action on a row to look up and add missing books.</p>

        <form id="match-books-form" class="flex flex-wrap items-center gap-3">
          <div class="flex-1 min-w-[220px]">
            <label for="match-username" class="sr-only">Username</label>
            <input id="match-username" name="username" class="w-full rounded-md bg-gray-900 border border-gray-700 px-3 py-2 text-gray-200" placeholder="StoryGraph username" aria-label="username" />
          </div>

          <div class="flex items-center gap-3">
            <label class="inline-flex items-center text-sm text-gray-300"><input id="type-ebook" type="checkbox" class="form-checkbox h-4 w-4" checked><span class="ml-2">eBook</span></label>
            <label class="inline-flex items-center text-sm text-gray-300"><input id="type-audio" type="checkbox" class="form-checkbox h-4 w-4" checked><span class="ml-2">AudioBook</span></label>
            <label class="inline-flex items-center text-sm text-gray-300 ml-2"><input id="match-refresh" type="checkbox" class="form-checkbox h-4 w-4"><span class="ml-2">Force SG refresh</span></label>
          </div>

          <div class="flex items-center gap-2 ml-auto">
            <button id="match-clear-btn" type="button" class="px-3 py-2 bg-gray-700 text-gray-200 rounded-md hover:bg-gray-600 text-sm">Clear</button>
            <button id="match-books-btn" type="submit" class="px-4 py-2 bg-sg-accent text-white rounded-md hover:bg-sg-accent-2 text-sm">Start Matching</button>
          </div>
        </form>

        <div id="match-books-meta" class="mt-3 text-sm text-gray-400"></div>
      </section>

      <section class="bg-gray-900 p-4 rounded-lg border border-gray-700">
        <h2 class="text-lg font-semibold text-white mb-3">Matches</h2>
        <div id="match-books-results" class="text-sm text-gray-200"></div>
      </section>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='match_books_widget.js') }}"></script>
{% endblock %}